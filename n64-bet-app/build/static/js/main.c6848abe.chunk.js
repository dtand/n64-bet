(this["webpackJsonpn64-bet-app"]=this["webpackJsonpn64-bet-app"]||[]).push([[0],{117:function(e,t){},121:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),l=a(26),r=a.n(l),o=(a(17),a(50)),c=(a(29),a(57),a(8)),i=a(9),m=a(13),u=a(11),p=a(10),h=a(12),d=a(49),g=a.n(d),b=a(122),E=a(123),f=a(125),y=a(124),B={"captain falcon":a(61),"donkey kong":a(62),fox:a(63),jigglypuff:a(64),kirby:a(65),link:a(66),luigi:a(67),mario:a(68),ness:a(69),pikachu:a(70),samus:a(71),yoshi:a(72)},S=function(e){function t(){return Object(c.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("img",{className:this.props.selected?"character-img-selected":"character-img",src:B[this.props.character.toLowerCase()]}))}}]),t}(s.a.Component),k=(a(73),a(18).numberWithCommas),v=a(18).toPercentString,N=function(e){function t(){return Object(c.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:1==this.props.player?"":"bet-player"},s.a.createElement(b.a,null,s.a.createElement(E.a,{className:"text-center"},s.a.createElement("br",null),s.a.createElement(S,{selected:this.props.userBet>0,character:this.props.character}),s.a.createElement("br",null),0!=this.props.doAnimation&&s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{style:{position:"absolute",top:"1%",left:"12%"}},s.a.createElement("h2",{className:"text-center fade-animation text-success fade-out"},s.a.createElement("b",null,"+",k(this.props.doAnimation))))),s.a.createElement("br",null),!this.props.bettingLocked&&s.a.createElement(s.a.Fragment,null,s.a.createElement(f.a,{onClick:function(){return e.props.betOnPlayer(e.props.player,1)},style:{backgroundColor:"#9147ff"},size:"md"}," + "),s.a.createElement(f.a,{onClick:function(){return e.props.betOnPlayer(e.props.player,-1)},style:{backgroundColor:"#9147ff"},size:"md"}," - "))),s.a.createElement(E.a,{className:"text-center"},s.a.createElement(y.a,null,s.a.createElement("br",null),s.a.createElement("h4",null,"Player ",this.props.player," | ",this.props.character),s.a.createElement("br",null),s.a.createElement("h4",null,"$",k(this.props.userBet)),s.a.createElement("br",null)))),s.a.createElement("br",null),s.a.createElement(b.a,null,s.a.createElement(E.a,{className:"text-center"},s.a.createElement(y.a,{className:"bet-player-bottom"},s.a.createElement(b.a,null,s.a.createElement(E.a,null,s.a.createElement("h5",null,s.a.createElement(b.a,null,s.a.createElement(E.a,null,"Pool"),s.a.createElement(E.a,null,s.a.createElement("span",null,"$",k(this.props.totalBet))))),s.a.createElement("h5",null,s.a.createElement(b.a,null,s.a.createElement(E.a,null,"Odds"),s.a.createElement(E.a,null,s.a.createElement("span",null,v(this.props.odds))))),s.a.createElement("h5",null,s.a.createElement(b.a,null,s.a.createElement(E.a,{className:this.props.userBet>0?"text-success":"text-white"},s.a.createElement("b",null,"Payout")),s.a.createElement(E.a,null,s.a.createElement("b",{className:this.props.userBet>0?"text-success":"text-white"},"$",k(this.props.payoutFactor*this.props.userBet)))))))))))}}]),t}(s.a.Component),w=a(14),x=a(27),O=a.n(x),D="https://n64-bet.herokuapp.com/";window.location.href.indexOf("localhost")>-1&&(D="http://localhost:8080/");var T=a(18).numberWithCommas,j=O()(D);j.on("connect",(function(e){console.log("connected"),j.emit("join","Hello World from client")})),j.on("disconnect",(function(e){console.log("disconnected"),j=O()(D)}));var _=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={loading:!0,loadingBetSection:!1,username:"",balance:0,games:[],gameData:{},userBets:[0,0,0,0],userTotal:0,playerSums:[],currentGameId:-1,bettingLocked:!1,hasSubmitted:!1,newBets:[!1,!1,!1,!1],betKeys:[0,0,0,0]},a.parseUsername=function(){var e=window.location.search;return new URLSearchParams(e).get("username")},a.loadHistoricalGames=function(){fetch(D+"v1/games").then((function(e){return e.json()})).then((function(e){a.setState({games:e,currentGameId:e[e.length-1].id}),a.loadCurrentGameInfo(e[e.length-1].id)})).catch(console.log)},a.loadPlayerBalance=function(){var e="";e=""==a.state.username?a.parseUsername():a.state.username,fetch(D+"v1/balance?username="+e).then((function(e){return e.json()})).then((function(e){console.log(e),a.setState({balance:e.balance})})).catch(console.log)},a.loadCurrentGameInfo=function(e,t){console.log("grabbing game info: "+e),void 0==e&&(e=a.state.currentGameId,console.log("grabbing game info: "+e),void 0==e||e<0)||fetch(D+"v1/game?id="+e).then((function(e){return e.json()})).then((function(e){console.log(e);for(var t=[0,0,0,0],n=0,s=e.bets,l=0;l<s.length;l++)s[l].username==a.state.username&&(n+=s[l].total_bet,t[s[l].player_id-1]=s[l].total_bet);a.setState({gameData:e,playerSums:e.player_sums,loading:!1,userTotal:n,userBets:t,bettingLocked:n>0||a.state.hasSubmitted,loadingBetSection:!1,currentGameId:e.id})})).catch(console.log)},a.submitBets=function(){for(var e=[],t=Object(p.a)(a),n=0;n<a.state.userBets.length;n++)a.state.userBets[n]>0&&e.push({bet:a.state.userBets[n],player:n+1});var s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({game_id:a.state.currentGameId,username:a.state.username,bets:e})};fetch(D+"v1/bets",s).then((function(e){return e.json()})).then((function(e){e.success?t.loadCurrentGameInfo():console.log(e.message)})),w.NotificationManager.success("Your bets have been locked with a total wager of: "+a.state.userTotal,"Bets locked"),a.setState({hasSubmitted:!0,bettingLocked:!0})},a.updateTotalBet=function(e){var t=a.state.gameData;t.total_pot+=e,a.setState({userTotal:a.state.userTotal+e,gameData:t})},a.betOnPlayer=function(e,t){if(!(t<0&&0==a.state.userBets[e-1])){var n=a.state.gameData;n.total_pot+=t;var s=a.state.userBets,l=a.state.playerSums;s[e-1]=s[e-1]+t,l[e-1]=l[e-1]+t,a.setState({userTotal:a.state.userTotal+t,userBets:s,playerSums:l,gameData:n})}},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.loadHistoricalGames(),this.loadPlayerBalance(),this.setState({username:this.parseUsername()});var e=this;j.on("new_bets",(function(t){if(console.log(t),t.username!=e.state.username){var a=e.state.playerSums,n=e.state.newBets,s=e.state.gameData,l=e.state.betKeys;console.log(s);for(var r=0;r<t.bets.length;r++)a[t.bets[r].player-1]+=Number(t.bets[r].bet),0!=t.bets[r]?(n[t.bets[r].player-1]=Number(t.bets[r].bet),l[t.bets[r].player-1]++):n[t.bets[r].player-1]=!1,s.total_pot+=Number(t.bets[r].bet);console.log(s),e.setState({playerSums:a,newBets:n,gameData:s,betKeys:l})}})),j.on("game_resolved",(function(t){console.log("game resolved.."),w.NotificationManager.success("The game has completed and the winner is: player "+t.winner,"Game Completed"),e.loadPlayerBalance(),e.loadCurrentGameInfo()})),j.on("new_game",(function(t){console.log("new game.."),w.NotificationManager.success("A new game lobby has started!","New Game"),e.loadCurrentGameInfo(e.state.currentGameId+1,!0)}))}},{key:"componentWillUnmount",value:function(){this.timer=null}},{key:"render",value:function(){return s.a.createElement("div",{className:"App bg-all"},s.a.createElement(b.a,{className:"nav text-white"},s.a.createElement(E.a,{sm:"1"}),s.a.createElement(E.a,{className:"text-left"},s.a.createElement("h3",null,"N64 BET | Smash Bros")),s.a.createElement(E.a,{className:"text-right"},s.a.createElement("h3",null,s.a.createElement("span",{className:"primary-color"},this.state.username)," | Balance: $",T(this.state.balance))),s.a.createElement(E.a,{sm:"1"})),this.state.loading&&s.a.createElement("div",null,s.a.createElement("h1",{style:{position:"absolute",top:"50%",left:"50%"}},s.a.createElement("div",{className:"animate-flicker"},"Loading..."))),!this.state.loading&&s.a.createElement(s.a.Fragment,null,s.a.createElement("section",{className:"video-section"},s.a.createElement("br",null),s.a.createElement(g.a,{height:"512px",width:"100%",chat:"false",channel:"dtravas"}),!this.state.bettingLocked&&s.a.createElement("div",{className:"text-left pad-left-20"},s.a.createElement(f.a,{onClick:this.submitBets,style:{backgroundColor:"#9147ff"},size:"sm"},"PLACE BETS")),this.state.bettingLocked&&s.a.createElement("h5",{className:"text-white"},"YOUR BETS ARE SUBMITTED"),s.a.createElement(b.a,{className:"game-info-banner"},s.a.createElement(E.a,{className:"text-left"},s.a.createElement("div",{className:"pad-left-20"},"POT SIZE $",T(this.state.gameData.total_pot)," | YOUR BETS $",T(this.state.userTotal))),s.a.createElement(E.a,{className:"text-right"},s.a.createElement("div",{className:"pad-right-20"},"GAME: ",this.state.currentGameId," | MIN BET ",1," | MAX BET ",100," | BETTING IS ",this.state.gameData.betting_open&&s.a.createElement("span",{className:"text-success"},s.a.createElement("b",null,"OPEN")),!this.state.gameData.winner&&!this.state.gameData.betting_open&&s.a.createElement("span",{className:"text-danger"},s.a.createElement("b",null,"CLOSED")),this.state.gameData.winner&&s.a.createElement("span",{className:"text-success"},s.a.createElement("b",null,"RESOLVED - PLAYER ",this.state.gameData.winner," WON"))))))),!this.state.loading&&s.a.createElement("section",{className:this.state.bettingLocked?"bet-section-locked":"bet-section"},s.a.createElement(b.a,null,s.a.createElement(E.a,null,s.a.createElement(b.a,{className:"text-black"},s.a.createElement(E.a,null,s.a.createElement(N,{player:1,key:"p1-"+this.state.betKeys[0],doAnimation:this.state.newBets[0],character:this.state.gameData.metadata.characters[0],totalBet:this.state.playerSums[0],userBet:this.state.userBets[0],odds:0==this.state.gameData.total_pot?0:this.state.playerSums[0]/this.state.gameData.total_pot,payoutFactor:0==this.state.playerSums[0]?0:this.state.gameData.total_pot/this.state.playerSums[0],betOnPlayer:this.betOnPlayer,updateTotalBet:this.updateTotalBet,bettingLocked:this.state.bettingLocked})),s.a.createElement(E.a,null,s.a.createElement(N,{player:2,key:"p2-"+this.state.betKeys[1],doAnimation:this.state.newBets[1],character:this.state.gameData.metadata.characters[1],totalBet:this.state.playerSums[1],userBet:this.state.userBets[1],odds:0==this.state.gameData.total_pot?0:this.state.playerSums[1]/this.state.gameData.total_pot,payoutFactor:0==this.state.playerSums[1]?0:this.state.gameData.total_pot/this.state.playerSums[1],betOnPlayer:this.betOnPlayer,updateTotalBet:this.updateTotalBet,bettingLocked:this.state.bettingLocked})),s.a.createElement(E.a,null,s.a.createElement(N,{player:3,key:"p3-"+this.state.betKeys[2],doAnimation:this.state.newBets[2],character:this.state.gameData.metadata.characters[2],totalBet:this.state.playerSums[2],userBet:this.state.userBets[2],odds:0==this.state.gameData.total_pot?0:this.state.playerSums[2]/this.state.gameData.total_pot,payoutFactor:0==this.state.playerSums[2]?0:this.state.gameData.total_pot/this.state.playerSums[2],betOnPlayer:this.betOnPlayer,updateTotalBet:this.updateTotalBet,bettingLocked:this.state.bettingLocked})),s.a.createElement(E.a,null,s.a.createElement(N,{player:4,key:"p4-"+this.state.betKeys[3],doAnimation:this.state.newBets[3],character:this.state.gameData.metadata.characters[3],totalBet:this.state.playerSums[3],userBet:this.state.userBets[3],odds:0==this.state.gameData.total_pot?0:this.state.playerSums[3]/this.state.gameData.total_pot,payoutFactor:0==this.state.playerSums[3]?0:this.state.gameData.total_pot/this.state.playerSums[3],betOnPlayer:this.betOnPlayer,updateTotalBet:this.updateTotalBet,bettingLocked:this.state.bettingLocked})))))),!this.state.loading&&this.state.loadingBetSection&&s.a.createElement("section",{className:"bet-section text-center"},s.a.createElement("h3",null,s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("div",{className:"animate-flicker"}," Fetching new bets..."),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("br",null))),s.a.createElement(w.NotificationContainer,null))}}]),t}(s.a.Component);var P=function(){var e=Object(n.useState)(!1),t=Object(o.a)(e,2);return t[0],t[1],s.a.createElement(_,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(120);r.a.render(s.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},17:function(e,t,a){},18:function(e,t){t.numberWithCommas=function(e){var t=(e=e.toFixed(2)).toString().split(".");return 1==t.length?e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):t[0].toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+"."+t[1]},t.toPercentString=function(e){return(e=(e*=100).toFixed(2)).toString()+"%"}},29:function(e,t,a){},52:function(e,t,a){e.exports=a(121)},61:function(e,t,a){e.exports=a.p+"static/media/captain-falcon.7e03e44e.png"},62:function(e,t,a){e.exports=a.p+"static/media/donkey-kong.4317ea84.png"},63:function(e,t,a){e.exports=a.p+"static/media/fox.2b342be5.png"},64:function(e,t,a){e.exports=a.p+"static/media/jigglypuff.a8bee105.png"},65:function(e,t,a){e.exports=a.p+"static/media/kirby.98999074.png"},66:function(e,t,a){e.exports=a.p+"static/media/link.967d372d.png"},67:function(e,t,a){e.exports=a.p+"static/media/luigi.37dc50ca.png"},68:function(e,t,a){e.exports=a.p+"static/media/mario.914bb2b4.png"},69:function(e,t,a){e.exports=a.p+"static/media/ness.a2a6917e.png"},70:function(e,t,a){e.exports=a.p+"static/media/pikachu.7918bdf2.png"},71:function(e,t,a){e.exports=a.p+"static/media/samus.bb8c010d.png"},72:function(e,t,a){e.exports=a.p+"static/media/yoshi.6e84f65e.png"}},[[52,1,2]]]);
//# sourceMappingURL=main.c6848abe.chunk.js.map